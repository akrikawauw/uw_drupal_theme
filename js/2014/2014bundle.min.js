(t=>{var e=window.document;window.UW=function(e){return e instanceof UW?e:this instanceof UW?void(this._wrapped=e):new UW(e)},(e.UW=UW).VERSION="0.1",UW.KEYCODES={TAB:9,ENTER:13,ESC:27},UW.elements={alert:".site-header",radio:":radio",checkbox:":checkbox",search:"#uwsearcharea",select:".uw-select",quicklinks:".uw-quicklinks"},UW.getBaseUrl=function(){var e=_.first(_.compact(t.history.location.pathname.split("/")));return t.history.location.origin||(t.history.location.origin=t.history.location.protocol+"//"+t.history.location.hostname+(t.history.location.port?":"+t.history.location.port:"")),-1!=t.history.location.origin.indexOf("www.washington.edu")||-1!=t.history.location.origin.indexOf("depts.washington.edu")?t.history.location.origin+(e?"/"+e:"")+"/":t.history.location.origin+"/"},UW.wpinstance=function(){return t.history.location.pathname||""},UW.sources={search:UW.getBaseUrl()+"wp-admin/admin-ajax.php"},UW.initialize=function(e){UW.$body=e("body"),UW.$window=e(window),UW.baseUrl=UW.getBaseUrl(),UW.alert=new UW.Alert({after:UW.elements.alert,model:new UW.Alert.Model}),UW.quicklinks=_.map(e(UW.elements.quicklinks),function(e){return new UW.QuickLinks({el:e})}),UW.select=_.map(e(UW.elements.select),function(e){return new UW.Select({el:e})})},jQuery(document).ready(function(){UW.initialize(jQuery)})})((Drupal,jQuery,Backbone)),((e,t)=>{UW.Alert=t.View.extend({alert:"#uwalert-alert-message",events:{"click .close":"hide"},template:'<div id="uwalert-alert-message" class="<% _.each( categories, function( category ) { %> <%= category.slug %> <% }) %>"><div class="container"><span class="close">Close</span><h1><%= title %></h1><p><%= excerpt %><a class="more" href="http://emergency.uw.edu" title="<%= title %>">More info</a></p></div></div>',initialize:function(e){_.bindAll(this,"render","hide"),this.options=_.extend({},e),this.model.on("sync",this.render)},render:function(){this.model.get("title")&&(e(this.options.after).after(_.template(this.template)(this.model.toJSON())),this.setElement(e(this.alert)))},hide:function(){this.$el.remove()}}),UW.Alert.Model=t.Model.extend({alerts:["red-alert-urgent","orange-alert","steel-alert-fyis"],data:{c:"?",test:!0,number:1,type:"post",status:"publish",dataType:"json"},url:"https://public-api.wordpress.com/rest/v1/sites/uwemergency.wordpress.com/posts/",initialize:function(){this.fetch({data:this.data})},parse:function(e){e=_.first(e.posts);if(_.extend(e.categories,{alert:{slug:window.location.hash.replace("#","")}}),_.intersection(_.pluck(e.categories,"slug"),this.alerts).length||-1!==e.categories.alert.slug.indexOf("uwalert"))return e}})})((Drupal,jQuery),Backbone),((a,e)=>{UW.QuickLinks=e.View.extend({container:"#page",events:{click:"animate",touchstart:"animate",keyup:"animate",blur:"loop"},initialize:function(e){_.bindAll(this,"inner_keydown","render","animate","accessible","loop","transitionEnd"),this.render()},render:function(){this.quicklinks=a("#quicklinks"),this.$container=a(this.container),this.$el.attr("aria-controls","quicklinks").attr("aria-owns","quicklinks"),UW.$body.on("keydown","#quicklinks",this.inner_keydown),UW.$body.on("keyup","#quicklinks a",this.animate),this.quicklinks.on("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",this.transitionEnd)},transitionEnd:function(e){this.open&&e.target==this.quicklinks[0]&&this.accessible()},inner_keydown:function(e){var t=this.quicklinks.find("a"),i=t[0],t=t[t.length-1],s=a("#little-links").find("a"),n=a("#big-links").find("a"),s=s[0],n=n[n.length-1];if(this.quicklinks.hasClass("open")){if(9==e.keyCode&&e.shiftKey)return a(":focus")[0]===i?(t.focus(),e.preventDefault()):a(":focus")[0]===s?(n.focus(),e.preventDefault()):a(":focus").closest("li").prev().find("a").trigger("focus"),!1;9==e.keyCode&&a(":focus")[0]===t&&(i.focus(),e.preventDefault())}},animate:function(e){if(e.preventDefault(),e.keyCode&&27!=e.keyCode&&(e.keyCode&&13!=e.keyCode||e.keyCode&&32!=e.keyCode))return!1;this.$container.toggleClass("open"),this.quicklinks.toggleClass("open"),this.open=this.quicklinks.hasClass("open"),this.loop(),this.accessible()},accessible:function(e){this.$el.attr("aria-expanded",this.open),this.open?(this.$el.attr("aria-label","Close quick links"),this.quicklinks.find("a").attr("tabindex",0).first().focus(),a("#page-inner").attr("aria-hidden",!0),a(".screen-reader-shortcut").attr("aria-hidden",!0)):(this.$el.attr("aria-label","Open quick links"),this.quicklinks.find("a").attr("tabindex",-1),this.$el.focus(),a("#page-inner").attr("aria-hidden",!1),a(".screen-reader-shortcut").attr("aria-hidden",!1))},loop:function(e){this.quicklinks.hasClass("open")&&this.quicklinks.find("li a").first().focus()}})})((Drupal,jQuery),Backbone),(e=>{UW.SearchToggle=e.View.extend({el:"button.uw-search",events:{click:"toggleSearchBar"},settings:{isOpen:!1},initialize:function(){},toggleSearchBar:function(){return this.settings.isOpen=!this.settings.isOpen,this.trigger("open"),UW.$body.toggleClass("search-open"),this.settings.isOpen?(this.$el.attr("aria-label","close search area"),this.$el.attr("aria-expanded","true")):(this.$el.attr("aria-label","open search area"),this.$el.attr("aria-expanded","false")),!1}})})((Drupal,jQuery,Backbone)),((t,e)=>{UW.Select=e.View.extend({el:".uw-select",submit:!1,current:0,keyCodes:{enter:13,spacebar:32,tab:9,up:38,down:40},events:{"keydown li":"openMenuOnKeydown","click li.active":"open","click li.inactive":"close","click .uw-select-arrow":"open","click .uw-select-arrow.open":"closeWithoutAnimating",click:"closeWithoutAnimating"},template:'<div class="uw-select-mask"><ul class="uw-select"><% _.each( lis, function( title, value ) { %><li data-value="<%= value %>"><a href="#"><%= title %></a></li><% }) %></ul><span class="uw-select-arrow"></span></div>',initialize:function(e){_.bindAll(this,"open","close","addOpenClass","removeOpenClass","closeWithoutAnimating"),this.options=_.extend({},this.settings,this.$el.data(),e),this.parseSelect(),this.render(),t("body").click(this.closeWithoutAnimating)},open:function(e){return this.isOpen()?this.closeWithoutAnimating():this.addOpenClass(),!1},close:function(e){this.$target=t(e.currentTarget);e=this.$target.index();return this.isDisabled(e)||(this.clicked=!0,this.current=e,this.animate(),this.toggleLIClasses()),!1},isDisabled:function(e){e=this.$el.find("li").eq(e).data().value;return this.$select.find('option[value="'+e+'"]').prop("disabled")},closeWithoutAnimating:function(){this.$el.removeClass("open"),this.$el.children().removeClass("open")},animate:function(){this.scroll=this.$target.offset().top-this.$el.find("li").first().offset().top,this.$el.children("ul").animate({scrollTop:this.scroll},{queue:!1,complete:this.removeOpenClass})},cloneSelectEvents:function(){var e=this.$el.find("li").eq(this.current).data().value;this.$select.val(e),this.$select.find('option[value="'+e+'"]').prop("selected",!0),this.submit&&this.$select.parent("form").submit(),this.trigger_link&&(window.location=e),this.$select.hasClass("uw-select-wp")&&(window.location=UW.baseUrl+"?cat="+e)},render:function(){this.html=_.template(this.template)({lis:this.LIs}),this.$el.hide().after(this.html),this.$select=this.$el,this.setElement(this.$el.next()),this.toggleLIClasses(),this.$el.find("li").length<7&&this.$el.children("ul").height("auto")},parseSelect:function(){var e=_.map(this.$el.find("option"),this.getValue),t=_.map(this.$el.find("option"),this.getText);this.$el.data("submit")&&(this.submit=!0),"links"==this.$el.data("type")&&(this.trigger_link=!0),this.current=this.$el.find(":selected").index(),this.LIs=_.object(e,t)},toggleLIClasses:function(){this.$el.find("li").removeClass().addClass("inactive"),this.$el.find("li").eq(this.current).removeClass().addClass("active")},addOpenClass:function(){this.$el.addClass("open"),this.$el.children().addClass("open"),this.$el.children("ul").scrollTop(this.scroll)},removeOpenClass:function(e){this.cloneSelectEvents(),(this.clicked||e)&&(this.$el.removeClass("open"),this.$el.children().removeClass("open"),this.clicked=!1)},getText:function(e){return t(e).text()},getValue:function(e){return e.value},openMenuOnKeydown:function(e){if(e.keyCode==this.keyCodes.tab&&!this.isOpen())return!0;if(_.contains(this.keyCodes,e.keyCode)){switch(this.isOpen()||this.open(),e.keyCode){case this.keyCodes.down:this.down();break;case this.keyCodes.up:this.up();break;case this.keyCodes.enter:case this.keyCodes.spacebar:this.current!=this.$select.val()&&(this.removeOpenClass(!0),this.toggleLIClasses(),this.cloneSelectEvents())}return!1}},up:function(){this.atEdge("up")||(--this.current,this.move())},down:function(){this.atEdge("down")||(this.current+=1,this.move())},move:function(){this.$target=this.$el.find("li").eq(this.current),this.$target.find("a").focus(),this.animate()},atEdge:function(e){return 0===this.current&&"up"===e||this.current===this.$el.find("li").length-1&&"down"===e},isOpen:function(){return this.$el.hasClass("open")}})})((Drupal,jQuery),Backbone);